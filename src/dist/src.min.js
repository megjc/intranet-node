function closeBtn(){function e(e,t,i,n){function o(e){var i=t.parent(),n=i[0].className;-1!=n.indexOf("modal")?i.removeClass("is-active"):i.addClass("hide")}t.bind("click",o)}var t={link:e,restrict:"A"};return t}function hdAutoComplete(e,t){function i(i,n,o,r){function c(e){i.query=e.name,i.show=!i.show,t.$broadcast("selected",i.query)}function s(){n[0].querySelector("results"),n.find("input");i.query.length>4?e.get("/api/users/search?q="+i.query).then(function(e){e.data.length>0&&(i.show=!i.show,i.results=e.data)})["catch"](function(e){console.log(e)}):(i.show=!1,i.results=[],t.$broadcast("unselected",{}))}n.bind("keyup",s);var a=n.find("input");a.on("blur",function(){console.log("exit")}),i.select=c,i.$on("submitted",function(e,t){i.query=""})}function n(){return'<div class="field autocomplete"><p class="control"><label class="label">My name is:</label><input class="input" type="text" placeholder="e.g. john brown" ng-model="query"><div class="results" ng-show="show"><p ng-repeat="result in results" ng-click="select(result)">{{result.name}}</p></div>'}var o={restrict:"E",link:i,scope:{data:"="},template:n()};return o}!function(){"use strict";function e(e,t){t.interceptors.push("interceptor"),t.interceptors.push("tokenInterceptor"),e.otherwise({redirectTo:"/users/login"})}function t(e){e.$on("$routeChangeSuccess",function(t,i,n){e.title=i.title})}function i(e,t,i){e.$on("$routeChangeStart",function(e,t,n){null!=t.access&&t.access.restricted&&i.validateToken().then(function(e){401==e.status&&i.handleUnAuthorized()})})}e.$inject=["$routeProvider","$httpProvider"],t.$inject=["$rootScope"],i.$inject=["$rootScope","$location","login"],angular.module("intranet",["ngRoute","ngMessages","apps.help","apps.cea","core.admin","core.services","core.interceptors","core.filters","core.login","core.nav","core.search","core.dashboard","apps.tod"]).config(e).run(t).run(i)}(),function(){"use strict";function e(e){e.when("/admin",{controller:"Admin",controllerAs:"vm",templateUrl:"views/core/admin/index.html",title:"Administration",access:{restricted:!0}}).when("/admin/users/ldap",{controller:"LDAPUser",controllerAs:"vm",templateUrl:"views/core/admin/ldap-users.html",title:"Administration",resolve:{ldap_users:["admin",function(e){return e.getLDAPUsers()}]},access:{restricted:!0}}).when("/admin/users",{controller:"User",controllerAs:"vm",templateUrl:"views/core/admin/users.html",title:"Administration",resolve:{users:["admin",function(e){return e.getUsers()}]},access:{restricted:!0}}).when("/admin/users/ldap/:dn",{controller:"Profile",controllerAs:"vm",templateUrl:"views/core/admin/profile.html",title:"Administration",resolve:{users:["admin",function(e){return e.getUsers()}]},access:{restricted:!0}})}function t(e,t,i){e.$on("$routeChangeStart",function(e,n,o){var r=t.path();-1!=r.indexOf("admin")&&i.isAdmin().then(function(e){401==e.status&&t.url("/dashboard/apps")})})}e.$inject=["$routeProvider"],t.$inject=["$rootScope","$location","login"],angular.module("core.admin",[]).config(e).run(t)}(),function(){"use strict";function e(e){e.when("/users/login",{templateUrl:"views/login/form.html",controller:"Login as vm",title:"Login ",access:{restricted:!1}}).otherwise({redirectTo:"/users/login"})}e.$inject=["$routeProvider"],angular.module("core.login",[]).config(e)}(),function(){"use strict";function e(e){e.when("/dashboard/apps/cea/contract-employees",{controller:"Employee as vm",title:"Contract Employee Administration",templateUrl:"views/apps/cea/employee-list.html",access:{restricted:!0},resolve:{create:["permission",function(e){return e.getByType("create")}],read:["permission",function(e){return e.getByType("read")}],update:["permission",function(e){return e.getByType("update")}],employees:["employeeSrv",function(e){return e.list()}]}}).when("/dashboard/apps/cea/new/employee",{controller:"CreateEmployee as vm",title:"New Employee",templateUrl:"views/apps/cea/create-employee.html",access:{restricted:!0},resolve:{activities:["common",function(e){return e.getActivities()}],classifications:["common",function(e){return e.getClassifications()}]}}).when("/dashboard/apps/cea/contract-employees/:id/edit",{controller:"EditEmployee as vm",title:"Edit Employee",templateUrl:"views/apps/cea/edit-employee.html",access:{restricted:!0},resolve:{activities:["common",function(e){return e.getActivities()}],classifications:["common",function(e){return e.getClassifications()}]}})}e.$inject=["$routeProvider"],angular.module("apps.cea",[]).config(e)}(),function(){"use strict";function e(e){e.when("/dashboard/apps",{controller:"Dashboard as vm",templateUrl:"views/dashboard/app-list.html",title:"Dashboard",resolve:{apps:["dashSrv",function(e){return e.getUserAppList()}]},access:{restricted:!0}})}e.$inject=["$routeProvider"],angular.module("core.dashboard",[]).config(e)}(),function(){"use strict";function e(e){e.when("/help-desk",{controller:"Help as vm",templateUrl:"templates/help-desk/form.html",title:"My Help Desk"})}e.$inject=["$routeProvider"],angular.module("apps.help",[]).config(e)}(),function(){"use strict";angular.module("core.nav",[])}(),function(){"use strict";function e(e){e.when("/dashboard/apps/search",{templateUrl:"views/search/searchResults.html",controller:"Search as vm",title:"Search ",access:{restricted:!0}})}e.$inject=["$routeProvider"],angular.module("core.search",[]).config(e)}(),function(){"use strict";function e(e){e.when("/dashboard/apps/tod/expired-docs",{templateUrl:"views/apps/tod/expires-list.html",controller:"ExpiryList as vm",title:"Expired Documents",resolve:{officers:["todSrv",function(e){return e.getExpiredDocs()}],create:["permission",function(e){return e.getByType("create")}],read:["permission",function(e){return e.getByType("read")}],update:["permission",function(e){return e.getByType("update")}]},access:{restricted:!0}}).when("/dashboard/apps/tod/notifications",{templateUrl:"views/apps/tod/notification-list.html",controller:"NotificationList as vm",title:"Notifications",resolve:{notifications:["todSrv",function(e){return e.getNotifications()}],create:["permission",function(e){return e.getByType("create")}],read:["permission",function(e){return e.getByType("read")}],update:["permission",function(e){return e.getByType("update")}]},access:{restricted:!0}}).when("/dashboard/apps/tod/officers",{templateUrl:"views/apps/tod/officer-listing.html",controller:"OfficerList as vm",title:"Officer Listing",resolve:{officers:["todSrv",function(e){return e.getOfficers()}],create:["permission",function(e){return e.getByType("create")}],read:["permission",function(e){return e.getByType("read")}],update:["permission",function(e){return e.getByType("update")}]},access:{restricted:!0}}).when("/dashboard/apps/tod/officers/new",{templateUrl:"views/apps/tod/create-officer.html",controller:"Officer as vm",title:"Add New Officer",resolve:{allowances:["todSrv",function(e){return e.getAllowances()}],classifications:["todSrv",function(e){return e.getClassifications()}],activities:["todSrv",function(e){return e.getActivities()}]},access:{restricted:!0}}).when("/dashboard/apps/tod/officers/:id/edit",{templateUrl:"views/apps/tod/edit-officer.html",controller:"EditOfficer as vm",title:"Edit Officer",access:{restricted:!0},resolve:{allowances:["todSrv",function(e){return e.getAllowances()}],classifications:["todSrv",function(e){return e.getClassifications()}],activities:["todSrv",function(e){return e.getActivities()}]}}).otherwise({redirectTo:"/login"})}e.$inject=["$routeProvider"],angular.module("apps.tod",[]).config(e)}(),function(){"use strict";function e(){function e(){console.log("Admin")}e()}angular.module("core.admin").controller("Admin",e)}(),function(){"use strict";function e(e,t){function i(){o.users=t}function n(t){e.path("/admin/users/ldap/"+t)}var o=this;o.view=n,i()}angular.module("core.admin").controller("LDAPUser",e),e.$inject=["$location","ldap_users"]}(),function(){"use strict";function e(e,t,i,n){function o(){s.access=i.appList(),s.user=i.extractNameFromDN(t.dn),s.department=i.extractDepartmentFromDN(t.dn),i.getApps(t.dn).then(function(e){s.apps=e.data})}function r(){s.show=!s.show}function c(){var e=0;if(angular.forEach(s.access,function(t,i){1==t&&(e++,s.accessList.push(i))}),e>0){var c={uname:s.user,dn:t.dn};i.addUser(c).then(function(e){for(var t=e.data.id,c={uid:t},a=0;a<s.accessList.length;a++)c.app_name=s.accessList[a],i.grantAccess(c).then(function(e){r(),s.message=e.data,n.emitEvent("notification"),o()})})}}var s=this;s.toggle=r,s.show=!1,s.save=c,s.accessList=[],s.message={},o(),n.subscribe(e,"notification",function(){s.notification={text:s.message.message,success:s.message.success,show:!0}})}angular.module("core.admin").controller("Profile",e),e.$inject=["$scope","$routeParams","admin","notify"]}(),function(){"use strict";function e(e){function t(){i.users=e}var i=this;t()}angular.module("core.admin").controller("User",e),e.$inject=["users"]}(),function(){"use strict";function e(e){function t(){return e.get("/api/users/ldap").then(function(e){return e.data})}function i(){return e.get("/api/users").then(function(e){return e.data})}function n(t){return e.get("/api/apps/"+t)}function o(e){var t=e.split(","),i=t[0],n=i.split("=");return n[1]}function r(e){var t=e.split(","),i=t[1].split("=");return i[1].toUpperCase()}function c(t){return e.post("/api/apps/grant_access",t)}function s(){return{"traveling officer database":!1}}function a(t){return e.post("/api/users",t)}var u={getLDAPUsers:t,getUsers:i,getApps:n,extractNameFromDN:o,extractDepartmentFromDN:r,grantAccess:c,appList:s,addUser:a};return u}angular.module("core.admin").service("admin",e),e.$inject=["$http"]}(),function(){"use strict";function e(e,t,i,n,o,r,c){function s(){u(o),0!=r.getToken()&&r.validateToken().then(function(t){t.data?e.path("/dashboard/apps"):e.path("/users/login")})}function a(){var t="/dashboard/apps";r.authUser(l.credentials).then(function(i){l.message=i.data,c.emitEvent("notification"),r.setToken(i.data.token),i.data.success&&n(function(){void 0!==o.redirectTo&&(t=decodeURI(o.redirectTo)),e.search(""),e.path(t)},500)})["catch"](function(e,t,n,o){delete i.sessionStorage.uid})}function u(e){var t,i="",n=!1,o={session_expired:{message:"Your session has expired. Please enter your username and password.",success:!1},logout:{message:"Logout successful.",success:!0}};for(var r in o)e.hasOwnProperty(r)&&(i=o[r].message,t=o[r].success,n=!0);n&&(l.notification=c.builder(i,t,!0),c.emitEvent("notification"))}var l=this;l.credentials=r.initUser(),l.auth=a,s(),c.subscribe(t,"notification",function(){l.notification=c.builder(l.message.message,l.message.success,!0)})}angular.module("core.login").controller("Login",e),e.$inject=["$location","$scope","$window","$timeout","$routeParams","login","notify"]}(),function(){"use strict";function e(e,t,i){function n(){var e=encodeURI(t.path());sessionStorage.removeItem("uid"),t.url("/users/login?session_expired=true&redirectTo="+e)}function o(t){return e.post("/api/users/auth/ldap",t)}function r(){return{name:"",password:""}}function c(){var e=i.sessionStorage.token;return null==e||0==e.length?!1:e}function s(e){null==e&&0==e.length||(i.sessionStorage.uid=e)}function a(){var t={method:"GET",url:"/api/token/verify",headers:{Authorization:"Bearer "+i.sessionStorage.uid}};return e(t)}function u(){delete i.sessionStorage.uid}function l(){return e.get("/api/users/me")}function f(){return e.get("/api/users/admin")}var d={authUser:o,initUser:r,getToken:c,setToken:s,validateToken:a,deleteToken:u,getUname:l,isAdmin:f,handleUnAuthorized:n};return d}angular.module("core.login").service("login",e),e.$inject=["$http","$location","$window"]}(),function(){"use strict";function e(e,t,i,n,o,r){function c(){l.classifications=o,l.activities=r}function s(e){e.$setPristine(),t.create(l.officer).then(function(n){l.message=n,c(),i.emitEvent("notification"),n.success&&(e.$setPristine(),l.officer=t.initOfficer(),l.selectedClassification="",l.selectedActivity="")})}function a(){l.officer.activity_id=l.selectedActivity}function u(){l.officer.classification_id=l.selectedClassification}var l=this;l.save=s,l.officer=t.initOfficer(),l.getSelectedClassificiation=u,l.getSelectedActivity=a,c(),i.subscribe(e,"notification",function(){l.notification={success:l.message.success,text:l.message.text,show:!0}})}angular.module("apps.cea").controller("CreateEmployee",e),e.$inject=["$scope","employeeSrv","notify","common","classifications","activities"]}(),function(){"use strict";function e(e,t,i,n,o,r,c){function s(){i.getEmployeeById(t.id).then(function(e){f.officer=e,f.activities=c,f.classifications=r,f.officer.start_date=new Date(e.start_date),f.officer.end_date=new Date(e.end_date);var t=n.findinList("id",e.classification_id,r),i=n.findinList("id",e.activity_id,c);f.selectedActivity=i.id,f.selectedClassification=t.id})}function a(){f.officer.classification_id=f.selectedClassification}function u(){f.officer.activity_id=f.selectedActivity}function l(){i.update(f.officer).then(function(e){f.message=e,s(),o.emitEvent("notification")})}var f=this;s(),f.save=l,f.getSelectedClassification=a,f.getSelectedActivity=u,o.subscribe(e,"notification",function(){f.notification={success:f.message.success,text:f.message.text,show:!0}})}angular.module("apps.cea").controller("EditEmployee",e),e.$inject=["$scope","$routeParams","employeeSrv","common","notify","classifications","activities"]}(),function(){"use strict";function e(e,t,i,n,o,r){function c(){}var s=this;c(),s.canCreate=e,s.canRead=t,s.canUpdate=i,s.employees=n}angular.module("apps.cea").controller("Employee",e),e.$inject=["create","read","update","employees","permission","employeeSrv"]}(),function(){"use strict";function e(e){function t(){return e.get("/api/employees?type=contract").then(function(e){return e.data})}function i(t){return e.get("/api/employees/"+t).then(function(e){return e.data})}function n(t){return e.put("/api/contract-employees/"+t.id,t).then(function(e){return e.data})}function o(t){return t.emp_type="C",t.is_traveling="F",t.allowance_type=0,e.post("/api/contract-employees",t).then(function(e){return e.data})}function r(){return{name:"",email:"",classification_id:"",position:"",activity_id:"",start_date:new Date,end_date:""}}var c={list:t,getEmployeeById:i,update:n,create:o,initOfficer:r};return c}angular.module("apps.cea").service("employeeSrv",e),e.$inject=["$http"]}(),angular.module("core.directives",[]).directive("closeBtn",closeBtn),function(){"use strict";function e(){return function(e){return e.charAt(0).toUpperCase()}}function t(){return function(e,t,i){return e===t?i:e}}angular.module("core.filters",[]).filter("charAt",e).filter("replaceWith",t)}(),function(){"use strict";angular.module("core.interceptors",[])}(),function(){"use strict";function e(){function e(e){return e.status>=400?e:void 0}var t={responseError:e};return t}angular.module("core.interceptors").factory("interceptor",e)}(),function(){"use strict";function e(e,t){function i(e){var i=t.path();return-1==i.indexOf("login")&&(e.headers.Authorization="Bearer "+sessionStorage.getItem("uid")),e}function n(t){return e.reject(t)}var o={request:i,responseError:n};return o}angular.module("core.interceptors").factory("tokenInterceptor",e),e.$inject=["$q","$location"]}(),function(){"use strict";angular.module("core.services",[])}(),function(){"use strict";function e(e){function t(){return e.get("/api/classifications").then(function(e){return e.data})}function i(){return e.get("/api/activities").then(function(e){return e.data})}function n(e,t,i){for(var n=0,o=!1;n<i.length;n++)if(i[n].hasOwnProperty(e)&&(o=i[n],o[e]==t))return o}var o={getClassifications:t,getActivities:i,findinList:n};return o}e.$inject=["$http"],angular.module("core.services").service("common",e)}(),function(){"use strict";function e(e){function t(t,i,n){var o=e.$on(i,n);t.$on("$destroy",o)}function i(t){e.$emit(t)}function n(e,t,i){return{text:e,success:t,show:i}}var o={subscribe:t,emitEvent:i,builder:n};return o}angular.module("core.services").service("notify",e),e.$inject=["$rootScope"]}(),function(){"use strict";function e(e){function t(t){var i=sessionStorage.getItem("_ai")||0;return e.get("/api/apps/"+i+" /permissions?type="+t).then(function(e){return e.data})}var i={getByType:t};return i}angular.module("core.services").service("permission",e),e.$inject=["$http"]}(),function(){"use strict";function e(e){function t(){n.apps=e}function i(e){sessionStorage.setItem("_ai",e)}var n=this;n.setAppId=i,t()}angular.module("core.dashboard").controller("Dashboard",e),e.$inject=["apps"]}(),function(){"use strict";function e(e){function t(){return e.get("/api/apps").then(function(e){return e.data})}var i={getUserAppList:t};return i}angular.module("core.dashboard").service("dashSrv",e),e.$inject=["$http"]}(),function(){"use strict";function e(e,t,i){function n(){s.ticket=i.initializeTicket(),s.ticket_types=i.getTicketTypes(),s.requests=i.getRequestTypes(s.ticket_types)}function o(){i.createTicket(s.ticket).then(function(e){s.message={success:e.data.success,text:e.data.text,show:!0},1==e.data.success&&(s.ticket=i.initializeTicket(),s.type="",t.ticketSubForm.$setUntouched())})["catch"](function(e){s.message=i.showError()}),e()}function r(){s.ticket=i.initializeTicket()}function c(e){s.ticket.type_id=e.id}var s=this;s.submit=o,s.cancel=r,s.select=c,n()}angular.module("apps.help").controller("Help",e),e.$inject=["$anchorScroll","$scope","helpService"]}(),angular.module("apps.help").directive("hdAutoComplete",hdAutoComplete),hdAutoComplete.$inject=["$http","$rootScope"],function(){"use strict";function e(e){function t(t){return e.post("/api/validate",{email:t})}function i(){return{description:"",type_id:"",email:""}}function n(e){}function o(){return[{id:1,title:"software issue"},{id:2,title:"general computer issue"},{id:4,title:"internet issue"},{id:5,title:"printer issue"},{id:6,title:"phone issue (CUG or desk phone)"},{id:7,title:"unknown issue"},{id:8,title:"setting up a new employee"},{id:9,title:"making a change to the Ministry's website"},{id:10,title:"setting up/configuring a closed user group cell phone"},{id:11,title:"creating a custom application for our division/branch"},{id:12,title:"setting up a projector/public announcement system"},{id:13,title:"providing support at an event/meeting"},{id:14,title:"other"}]}function r(e){return e.slice(6)}function c(e){return{success:!1,message:"Please review the form for errors"}}function s(t){return""==t.description&&(t.description="no description provided by user"),e.post("/api/tickets",t)}function a(){return{error:!0,text:"We are unable to submit your issue at this time.",show:!0}}var u={initializeTicket:i,isEmpty:n,getTicketTypes:o,getRequestTypes:r,showMessage:c,createTicket:s,showError:a,validate:t};return u}angular.module("apps.help").service("helpService",e),e.$inject=["$http"]}(),function(){"use strict";function e(e,t){function i(){t.getUname().then(function(e){o.username=e.data})}function n(){t.deleteToken(),e.url("/users/login?logout=true")}var o=this;o.logout=n,i()}angular.module("core.nav").controller("Nav",e),e.$inject=["$location","login"]}(),function(){"use strict";function e(e,t){function i(){var i=t.q||"";"undefined"==typeof i&&""==i||e.get("/api/search?app=1&q="+i).then(function(e){n.results=e.data})["catch"](function(e){n.resuls=[]})}var n=this;i()}angular.module("core.search").controller("Search",e),e.$inject=["$http","$routeParams"]}(),function(){"use strict";function e(e,t,i,n,o,r){function c(){d.allowances=e,d.classifications=t,d.activities=i}function s(e){r.createOfficer(d.officer).then(function(t){d.message=t,e.$setPristine(),t.success&&(d.officer=r.initOfficerForm(),d.selectedClassification="",d.selectedAllowance="",d.selectedActivity=""),o.emitEvent("notification")})}function a(){d.officer.classification_id=d.selectedClassification}function u(){switch(d.officer.allowance_type=d.selectedAllowance,d.selectedAllowance){case 1:case 3:case 5:case 7:case 11:case 13:case 15:case 17:case 19:d.toggleBox=!d.toggleBox,d.officer.vehicle_required=!0,d.vehicle_details_required=!0;break;default:d.toggleBox=!1}}function l(){d.officer.activity_id=d.selectedActivity}function f(){d.showPermissionDate=!d.showPermissionDate,d.officer.is_owner||(d.permissionRequired=!d.permissionRequired)}var d=this;d.save=s,d.officer=r.initOfficerForm(),d.getSelected=a,d.getSelectedActivity=l,d.getSelectedAllowance=u,d.toggle=f,d.showPermissionDate=!1,d.toggleBox=!1,d.vehicle_details_required=!1,d.permissionRequired=!1,c(),o.subscribe(n,"notification",function(){d.notification=o.builder(d.message.message,d.message.success,!0)})}angular.module("apps.tod").controller("Officer",e),e.$inject=["allowances","classifications","activities","$scope","notify","todSrv"]}(),function(){"use strict";function e(e,t,i,n,o,r,c,s){function a(){o.getOfficerById(i.id).then(function(e){b.officer=e,b.classifications=c,b.allowances=r,b.activities=s,b.addVehicle=u(e),b.selectedClassification=f("id",e.classification_id,c),b.selectedAllowance=f("id",e.allowance_type,r),b.selectedActivity=f("id",e.activity_id,s),b.isOfficer="T"==e.is_traveling,b.disabled="F"==e.is_traveling,e.docs.length>0&&(b.officer.license=new Date(e.docs[0].expiry_date),b.officer.fitness=new Date(e.docs[1].expiry_date),b.officer.registration=new Date(e.docs[2].expiry_date),b.officer.insurance=new Date(e.docs[3].expiry_date))})}function u(e){return null==e.vehicle_id}function l(){o.createVehicle(b.vehicle).then(function(e){b.message=e,b.toggleCreate(),a(),n.emitEvent("notification"),_()})}function f(e,t,i){for(var n=0,o=!1;n<i.length;n++)if(i[n].hasOwnProperty(e)&&(o=i[n],o[e]==t))return o}function d(e){o.update(b.officer,e,null,null).then(function(e){b.message=e,a(),n.emitEvent("notification"),_()})}function p(){o.compareString(b.confirm,b.officer.name)&&(d("remove-officer"),w())}function m(){b.officer.activity_id=b.selectedActivity.id}function g(){b.officer.allowance_type=b.selectedAllowance.id}function h(){b.officer.classification_id=b.selectedClassification.id}function v(){o.updateVehicle(b.officer).then(function(e){b.message=e,n.emitEvent("notification"),_()})}function y(e,t,i){var r={employee_id:i,expiry_date:t,id:e};o.updateDoc(r).then(function(e){b.message=e,n.emitEvent("notification"),_()})}function w(){b.active=!b.active}function $(){b.createActive=!b.createActive}function _(){e.scrollTo(0,0)}function A(e){b.vehicle.employee_id=e,$()}var b=this;b.update=d,a(),b.updateDoc=y,b.updateVehicle=v,b.getSelectedActivity=m,b.getSelectedAllowance=g,b.getSelectedClassification=h,b.toggle=w,b.removeOfficer=p,b.addVehicle=!1,b.createVehicle=A,b.toggleCreate=$,b.saveVehicle=l,b.createActive=!1,b.confirm="",b.active=!1,b.disabled=!1,b.vehicle={},n.subscribe(t,"notification",function(){b.notification={success:b.message.success,text:b.message.text,show:!0}})}angular.module("apps.tod").controller("EditOfficer",e),e.$inject=["$window","$scope","$routeParams","notify","todSrv","allowances","classifications","activities"]}(),function(){"use strict";function e(e,t,i,n,o,r,c,s){function a(){d.canCreate=n,d.canRead=o,d.canUpdate=r,d.officers=i}function u(e){d.docs=e.docs,l()}function l(){d.active=!d.active}function f(e){l(),c.sendNotification(e).then(function(e){d.message=e,s.emitEvent("notification")})}var d=this;d.notifyOfficer=u,d.sendNotification=f,d.active=!1,d.toggle=l,a(),s.subscribe(t,"notification",function(){d.notification=s.builder(d.message.text,d.message.success,!0)})}angular.module("apps.tod").controller("ExpiryList",e),e.$inject=["$location","$scope","officers","create","read","update","todSrv","notify"]}(),function(){"use strict";function e(e,t,i,n,o,r){function c(){s.canCreate=i,s.canRead=n,s.canUpdate=o,s.notifications=t}var s=this;c()}angular.module("apps.tod").controller("NotificationList",e),e.$inject=["$location","notifications","create","read","update","todSrv"]}(),function(){"use strict";function e(e,t,i,n,o,r){function c(){f.officers=r}function s(e){n.getDocsByOfficerId(e).then(function(t){a(e),d.push(e),f.documents=t.data})}function a(e){0!=d.length?(u(),document.getElementById(e).classList.toggle("show")):document.getElementById(e).classList.toggle("show")}function u(){for(var e,t=0;t<d.length;t++)e=document.getElementById(d[t]),e.classList.contains("show")&&e.classList.remove("show")}function l(){"undefined"!=typeof f.query&&o.url("/dashboard/apps/search?q="+f.query)}var f=this;f.showDocs=s,f.showModal=!1,f.query="",f.search=l;var d=[];f.canCreate=e,f.canRead=t,f.canUpdate=i,c(),window.onclick=function(e){e.target.matches(".src")||u()}}angular.module("apps.tod").controller("OfficerList",e),e.$inject=["create","read","update","todSrv","$location","officers"]}(),function(){"use strict";function e(e){function t(){var t=sessionStorage.getItem("_ai");return e.get("/api/notifications/"+t).then(function(e){return e.data})}function i(){return e.get("/api/employees").then(function(e){return e.data})}function n(t){return e.get("/api/employees/"+t+"/documents")}function o(){return!1}function r(t){return e.post("/api/employees?traveling=true",t).then(function(e){return e.data})}function c(t){return e.post("/api/vehicles",t).then(function(e){return e.data})}function s(){return e.get("/api/allowances").then(function(e){return e.data})}function a(){return e.get("/api/classifications").then(function(e){return e.data})}function u(){return{name:"",email:"",classification:"",allowance_type:"",position:"",activity_id:"",insurance:new Date,registration:new Date,license:new Date,fitness:new Date,permission_date:new Date,is_owner:!0,comment:"",vehicle_required:!1}}function l(){return e.get("/api/activities").then(function(e){return e.data})}function f(t){return e.get("/api/employees/"+t).then(function(e){return e.data})}function d(e){return{id:e.id,name:e.name,email:e.email,position:e.position,classification_id:e.classification_id,activity_id:e.activity_id,allowance_type:e.allowance_type,is_traveling:e.is_traveling}}function p(e){return{id:e.vehicle_id,plate:e.plate,make:e.make,model:e.model,year:e.vehicle_year}}function m(t,i,n,o){var r={},c="/api/employees/"+t.id;return"employee"==i?r=d(t):"remove-officer"==i&&(t.is_traveling="F",r=d(t)),e.put(c,r).then(function(e){return e.data})}function g(t){var i=p(t);return e.put("/api/vehicles/"+t.vehicle_id,i).then(function(e){return e.data})}function h(t){return e.put("/api/documents/"+t.id,t).then(function(e){return e.data})}function v(){return e.get("/api/expired").then(function(e){return e.data})}function y(t){return e.put("/api/employees/"+t,{is_traveling:"F"}).then(function(e){return e.data})}function w(e){var t=["remove-officer"];return t.indexOf(e)>-1}function $(e,t){return e.toLowerCase()==t.toLowerCase()}function _(t){var i=sessionStorage.getItem("_ai");return e.post("/api/notify/"+i,t).then(function(e){return e.data})}var A={getOfficers:i,getDocsByOfficerId:n,initModal:o,createOfficer:r,createVehicle:c,getAllowances:s,getClassifications:a,initOfficerForm:u,getActivities:l,getOfficerById:f,update:m,updateDoc:h,getExpiredDocs:v,updateVehicle:g,removeOfficer:y,checkSection:w,compareString:$,sendNotification:_,getNotifications:t};return A}angular.module("apps.tod").service("todSrv",e),e.$inject=["$http"]}();